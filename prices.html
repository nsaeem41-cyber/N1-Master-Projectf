<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>N One | Ù…ØµÙÙˆÙØ© Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ù…Ø§Ø³ÙŠØ© (Final Edition)</title>
    
    <script src="https://cdn.jsdelivr.net/gh/nsaeem41-cyber/N1-Master-Project@main/n-one-core.js"></script>

    <style>
        /* ================= ØªØµÙ…ÙŠÙ… Diamond Matrix (Navy & Gold) ================= */
        :root {
            --primary: #1a237e;      /* ÙƒØ­Ù„ÙŠ Ù…Ù„ÙƒÙŠ */
            --gold: #d4af37;         /* Ø°Ù‡Ø¨ÙŠ */
            --bg: #eceff1;           /* Ø®Ù„ÙÙŠØ© Ø±Ù…Ø§Ø¯ÙŠØ© ÙØ§ØªØ­Ø© Ø¬Ø¯Ø§Ù‹ */
            --text: #37474f;            
            --success: #2e7d32;      
            --danger: #c62828;
            --night: #311b92;        /* Ù„ÙˆÙ† Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ */
        }

        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background-color: var(--bg); margin: 0; padding: 0; 
            color: var(--text); user-select: none; 
        }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…Ù„ÙƒÙŠ */
        .navbar { 
            background: var(--primary); height: 70px; 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 0 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); 
            border-bottom: 4px solid var(--gold);
            position: sticky; top: 0; z-index: 1000; transition: 0.5s;
        }
        /* ÙˆØ¶Ø¹ Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù„ÙŠÙ„ÙŠ */
        .navbar.night-mode { background: linear-gradient(45deg, #000000, #311b92); border-bottom-color: #7c4dff; }

        .brand { font-size: 24px; font-weight: 900; color: white; letter-spacing: 1px; }
        .gold-text { color: var(--gold); }
        
        .btn-back { background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 8px 15px; border-radius: 6px; cursor: pointer; text-decoration: none; font-size: 14px; transition: 0.3s; }
        .btn-back:hover { background: rgba(255,255,255,0.2); }

        .container { max-width: 1200px; margin: 30px auto; padding: 20px; }

        /* Ø¨Ù†Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù„ÙŠÙ„ÙŠ */
        .night-control-bar {
            background: white; padding: 15px; border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-bottom: 20px;
            display: flex; justify-content: space-between; align-items: center;
            border-left: 5px solid var(--night);
        }
        
        /* Ø²Ø± Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ (Switch) */
        .switch { position: relative; display: inline-block; width: 50px; height: 24px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--night); }
        input:checked + .slider:before { transform: translateX(26px); }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        .controls-panel { 
            background: white; padding: 20px; border-radius: 15px; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.05); margin-bottom: 30px;
            border-top: 4px solid var(--gold);
        }
        
        .controls-row { display: flex; justify-content: space-between; align-items: center; gap: 20px; margin-bottom: 15px; }
        
        /* Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ØµØ¯Ø± */
        .source-group { display: flex; gap: 10px; align-items: center; flex: 1; }
        .source-select { padding: 12px; border: 2px solid var(--primary); border-radius: 8px; font-weight: bold; color: var(--primary); outline: none; flex: 1; font-size: 15px; }
        
        .btn-icon { width: 40px; height: 40px; border-radius: 8px; border: none; cursor: pointer; font-size: 18px; transition: 0.2s; display: flex; align-items: center; justify-content: center; background: #eee; }
        .btn-icon:hover { transform: scale(1.1); }
        
        /* Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± */
        .search-box { flex: 2; position: relative; }
        .search-input { width: 100%; padding: 12px 40px 12px 15px; border: 1px solid #ccc; border-radius: 8px; outline: none; background: #fafafa; font-size: 14px; box-sizing: border-box; }
        .search-icon { position: absolute; right: 10px; top: 12px; color: #999; }

        .action-btns { display: flex; gap: 10px; }
        .btn-main { padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.3s; color: white; display: flex; align-items: center; gap: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); font-size: 14px; }
        
        .btn-save { background: var(--success); }
        .btn-save:hover { background: #1b5e20; transform: translateY(-2px); }
        .btn-dup { background: #546e7a; } /* Ø²Ø± Ø§Ù„Ù†Ø³Ø® */
        
        /* Ø§Ù„Ù…ØµÙÙˆÙØ© (Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬) */
        .matrix-container { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }

        .price-card {
            background: white; border-radius: 10px; padding: 10px 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); border: 1px solid #eee;
            display: flex; align-items: center; gap: 10px; transition: 0.2s;
            position: relative; overflow: hidden;
        }
        .price-card:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); border-color: var(--primary); }

        /* Ø§Ù„ÙƒØ±Øª Ø§Ù„Ø°Ù‡Ø¨ÙŠ (Ø¹Ø±Ø¶ Ø®Ø§Øµ) */
        .price-card.gold-offer {
            background: linear-gradient(135deg, #fffde7, #fff9c4);
            border: 1px solid var(--gold);
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
        }
        .price-card.gold-offer .area-name-input { color: #f57f17; }

        /* Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ±Ù†Ø¯ */
        .trend-icon { font-size: 10px; position: absolute; top: 2px; left: 5px; opacity: 0.7; }

        /* Ù…Ø¤Ø´Ø± Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ */
        .color-indicator { width: 5px; height: 100%; position: absolute; right: 0; top: 0; }
        .low-price { background: #66bb6a; } 
        .med-price { background: #ffa726; } 
        .high-price { background: #ef5350; } 

        .area-name-input { border: none; font-weight: bold; font-size: 14px; color: #333; flex: 1; outline: none; background: transparent; }
        .area-name-input:focus { border-bottom: 2px solid var(--primary); }

        /* Ø®Ø§Ù†Ø© Ø§Ù„Ø³Ø¹Ø± */
        .price-wrapper { position: relative; display: flex; align-items: center; }
        .price-val-input { width: 60px; padding: 5px; border: 1px solid #ddd; border-radius: 6px; text-align: center; font-weight: bold; color: var(--primary); outline: none; }
        .price-val-input:focus { border-color: var(--gold); background: #fff; }
        
        /* Ø´Ø§Ø±Ø© Ø§Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù„ÙŠÙ„ÙŠØ© */
        .night-badge { 
            font-size: 10px; background: var(--night); color: white; 
            padding: 2px 5px; border-radius: 4px; position: absolute; 
            top: -10px; right: 0; white-space: nowrap; pointer-events: none;
        }

        /* Ø£Ø¯ÙˆØ§Øª Ø§Ù„ÙƒØ±Øª Ø§Ù„ØµØºÙŠØ±Ø© */
        .card-tools { display: flex; gap: 5px; align-items: center; }
        .mini-btn { background: none; border: none; cursor: pointer; font-size: 16px; transition: 0.2s; opacity: 0.6; }
        .mini-btn:hover { opacity: 1; transform: scale(1.2); }
        .btn-map { color: #1976d2; }
        .btn-offer { color: #ccc; } /* Ø±Ù…Ø§Ø¯ÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§ */
        .btn-offer.active { color: #ffb300; text-shadow: 0 0 5px #ffb300; opacity: 1; }

        /* ØªØ±ÙˆÙŠØ³Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù…Ø®ÙÙŠØ© */
        .print-header { display: none; text-align: center; border-bottom: 3px solid var(--gold); padding-bottom: 10px; margin-bottom: 20px; }

        /* ================= ØªØµÙ…ÙŠÙ… Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ================= */
        @media print {
            body { background: white; -webkit-print-color-adjust: exact; }
            .navbar, .controls-panel, .night-control-bar, .card-tools, .btn-main, .night-badge { display: none !important; }
            .container { margin: 0; padding: 0; max-width: 100%; }
            .print-header { display: block; }
            .matrix-container { display: block; column-count: 2; column-gap: 20px; }
            .price-card { break-inside: avoid; border: 1px solid #ccc; box-shadow: none; margin-bottom: 10px; padding: 5px 10px; }
            .area-name-input, .price-val-input { border: none; background: transparent; }
            .price-val-input { text-align: left; }
        }
    </style>
</head>
<body>

    <nav class="navbar" id="Prc_MainNav">
        <div class="brand">N <span class="gold-text">One</span> Smart Matrix</div>
        <a href="client.html" class="btn-back">â¬…ï¸ Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©</a>
    </nav>

    <div class="container">
        
        <div class="night-control-bar">
            <div style="display:flex; align-items:center; gap:10px;">
                <span style="font-size:24px;">ğŸŒ™</span>
                <div>
                    <div style="font-weight:bold; font-size:14px; color:#37474f;">Ø§Ù„Ø­Ø§Ø±Ø³ Ø§Ù„Ù„ÙŠÙ„ÙŠ (Ø§Ù„ØªØ³Ø¹ÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ)</div>
                    <div style="font-size:11px; color:#777;">Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø²ÙŠØ§Ø¯Ø© 0.50 Ø¯.Ø£ Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø© 11:00 Ù…</div>
                </div>
            </div>
            <label class="switch">
                <input type="checkbox" id="Prc_NightToggle" onchange="Prc_ToggleNightModeOverride()" checked>
                <span class="slider"></span>
            </label>
        </div>

        <div class="controls-panel">
            <div class="controls-row">
                <div class="source-group">
                    <label style="font-weight:bold; font-size:12px;">Ø§Ù„Ù…ØµØ¯Ø±</label>
                    <select id="Prc_SourceSelect" class="source-select" onchange="Prc_RenderMatrix()">
                        </select>
                    <button class="btn-icon" onclick="Prc_AddSource()" title="Ø¥Ø¶Ø§ÙØ© Ù…ØµØ¯Ø± Ø¬Ø¯ÙŠØ¯">â•</button>
                    <button class="btn-icon" onclick="Prc_DuplicateSource()" title="Ù†Ø³Ø® Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (Quick Duplicate)" style="background:#e3f2fd; color:#1565c0;">ğŸ“‘</button>
                    <button class="btn-icon" onclick="Prc_DeleteSource()" title="Ø­Ø°Ù Ø§Ù„Ù…ØµØ¯Ø±" style="background:#ffebee; color:var(--danger);">ğŸ—‘ï¸</button>
                </div>

                <div class="search-box">
                    <span class="search-icon">ğŸ”</span>
                    <input type="text" id="Prc_SearchInput" class="search-input" placeholder="Ø¨Ø­Ø« Ø°ÙƒÙŠ Ø¹Ù† Ù…Ù†Ø·Ù‚Ø©" oninput="Prc_RenderMatrix()">
                </div>
            </div>

            <div class="controls-row" style="justify-content: flex-end; margin-bottom:0;">
                <div class="action-btns">
                    <button class="btn-main" style="background:#37474f;" onclick="Prc_AddArea()">+ Ù…Ù†Ø·Ù‚Ø©</button>
                    <button class="btn-main" style="background:var(--primary);" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
                    <button class="btn-main btn-save" onclick="Prc_SaveData()">ğŸ’¾ Ø­ÙØ¸ ÙˆØ§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</button>
                </div>
            </div>
        </div>

        <div class="print-header">
            <h1 style="color:#1a237e; margin:0;">N <span style="color:#d4af37">One</span> Delivery</h1>
            <p style="margin:5px 0; color:#555; font-size:14px;">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© - <span id="Prc_PrintSourceName"></span></p>
        </div>

        <div id="Prc_MatrixGrid" class="matrix-container">
            </div>

    </div>

    <script>
        // ========================================================
        // ÙƒÙˆØ¯ Ø§Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø§Ø³ÙŠØ© Ø§Ù„Ù…Ø´ÙØ± - v5.0 (Full Manual Control)
        // ========================================================
        
        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        const Prc_DefaultData = {
            "Ø§Ù„Ø¬Ø¨ÙŠÙ‡Ø©": [
                { area: "Ø­ÙŠ Ø§Ù„Ø±ÙŠØ§Ù† / Ø§Ù„Ø²ÙˆØªÙ†ÙŠØ©", price: 1.50, isOffer: false, lastMod: Date.now() },
                { area: "Ø¶Ø§Ø­ÙŠØ© Ø§Ù„Ø±Ø´ÙŠØ¯", price: 2.00, isOffer: true, lastMod: Date.now() },
                { area: "ØªÙ„Ø§Ø¹ Ø§Ù„Ø¹Ù„ÙŠ / Ø³ÙˆÙ‚ Ø§Ù„Ø³Ù„Ø·Ø§Ù†", price: 2.50, isOffer: false, lastMod: Date.now() },
                { area: "Ø®Ù„Ø¯Ø§ / Ø£Ù… Ø§Ù„Ø³Ù…Ø§Ù‚", price: 3.00, isOffer: false, lastMod: Date.now() },
                { area: "Ø¯Ø§Ø¨ÙˆÙ‚ / Ø§Ù„Ø±Ø§Ø¨ÙŠØ©", price: 4.00, isOffer: false, lastMod: Date.now() },
                { area: "Ù…Ø±Ø¬ Ø§Ù„Ø­Ù…Ø§Ù…", price: 6.00, isOffer: false, lastMod: Date.now() }
            ]
        };

        // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        let Prc_PricingData = JSON.parse(localStorage.getItem('Prc_GlobalPricesDB')) || Prc_DefaultData;
        let Prc_IsNightActive = false; // Ù‡Ù„ Ø§Ù„ØªØ³Ø¹ÙŠØ± Ø§Ù„Ù„ÙŠÙ„ÙŠ Ù…ÙØ¹Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹

        window.onload = function() {
            // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø­Ø§Ù„Ø© Ù…ÙØªØ§Ø­ Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ù„ÙŠÙ„ÙŠ
            const Prc_SavedToggle = localStorage.getItem('Prc_NightToggleDB');
            if (Prc_SavedToggle !== null) {
                document.getElementById('Prc_NightToggle').checked = (Prc_SavedToggle === 'true');
            }
            
            Prc_CheckNightMode();
            Prc_PopulateSources();
            Prc_RenderMatrix();
            
            // ÙØ­Øµ Ø§Ù„ÙˆÙ‚Øª ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
            setInterval(Prc_CheckNightMode, 60000);
        };

        // 1. Ù…Ù†Ø·Ù‚ Ø§Ù„Ø­Ø§Ø±Ø³ Ø§Ù„Ù„ÙŠÙ„ÙŠ (ÙŠØ¯ÙˆÙŠ + Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒ)
        function Prc_CheckNightMode() {
            const Prc_Hour = new Date().getHours();
            // Ø§Ù„ÙˆÙ‚Øª Ù…Ù† 11 Ù… (23) Ø¥Ù„Ù‰ 6 Øµ (6)
            const Prc_IsNightTime = (Prc_Hour >= 23 || Prc_Hour < 6);
            // Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„ÙŠØ¯ÙˆÙŠ Ù‡Ù„ Ø³Ù…Ø­ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ØªØ³Ø¹ÙŠØ± Ø§Ù„Ù„ÙŠÙ„ÙŠ
            const Prc_IsToggleOn = document.getElementById('Prc_NightToggle').checked;
            
            // Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø§Ù„ÙˆÙ‚Øª Ù„ÙŠÙ„ + Ø§Ù„Ù…ÙØªØ§Ø­ Ø´ØºØ§Ù„
            const Prc_ShouldBeNight = Prc_IsNightTime && Prc_IsToggleOn;

            if (Prc_ShouldBeNight !== Prc_IsNightActive) {
                Prc_IsNightActive = Prc_ShouldBeNight;
                Prc_RenderMatrix(); // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù… Ø§Ù„Ø£Ø³Ø¹Ø§Ø±
            }

            // ØªØ­Ø¯ÙŠØ« Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ù‡ÙŠØ¯Ø± ÙÙ‚Ø·
            const Prc_Nav = document.getElementById('Prc_MainNav');
            if (Prc_IsNightActive) Prc_Nav.classList.add('night-mode');
            else Prc_Nav.classList.remove('night-mode');
        }

        function Prc_ToggleNightModeOverride() {
            // Ø­ÙØ¸ ØªÙØ¶ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const Prc_IsChecked = document.getElementById('Prc_NightToggle').checked;
            localStorage.setItem('Prc_NightToggleDB', Prc_IsChecked);
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙØ­Øµ Ø§Ù„ÙÙˆØ±ÙŠ
            Prc_CheckNightMode();
        }

        // 2. Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØµØ§Ø¯Ø±
        function Prc_PopulateSources() {
            const Prc_Select = document.getElementById('Prc_SourceSelect');
            const Prc_CurrentVal = Prc_Select.value;
            Prc_Select.innerHTML = '';
            Object.keys(Prc_PricingData).forEach(Prc_Source => {
                const Prc_Option = document.createElement('option');
                Prc_Option.value = Prc_Source;
                Prc_Option.innerText = Prc_Source;
                Prc_Select.appendChild(Prc_Option);
            });
            if (Prc_CurrentVal && Prc_PricingData[Prc_CurrentVal]) Prc_Select.value = Prc_CurrentVal;
        }

        function Prc_AddSource() {
            const Prc_Name = prompt("Ø§Ø³Ù… Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯");
            if (Prc_Name && !Prc_PricingData[Prc_Name]) {
                Prc_PricingData[Prc_Name] = [];
                Prc_PopulateSources();
                document.getElementById('Prc_SourceSelect').value = Prc_Name;
                Prc_RenderMatrix();
                Prc_SaveData(true);
            }
        }

        function Prc_DuplicateSource() {
            const Prc_Current = document.getElementById('Prc_SourceSelect').value;
            const Prc_NewName = prompt(`Ù†Ø³Ø® Ù‚Ø§Ø¦Ù…Ø© ${Prc_Current} Ø¥Ù„Ù‰ Ù…Ø¯ÙŠÙ†Ø© Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ø³Ù…`);
            if (Prc_NewName && !Prc_PricingData[Prc_NewName]) {
                Prc_PricingData[Prc_NewName] = JSON.parse(JSON.stringify(Prc_PricingData[Prc_Current]));
                Prc_PopulateSources();
                document.getElementById('Prc_SourceSelect').value = Prc_NewName;
                Prc_RenderMatrix();
                Prc_SaveData(true);
            }
        }

        function Prc_DeleteSource() {
            const Prc_Current = document.getElementById('Prc_SourceSelect').value;
            if (confirm(`Ø­Ø°Ù Ù‚Ø§Ø¦Ù…Ø© ${Prc_Current} Ù†Ù‡Ø§Ø¦ÙŠØ§`)) {
                delete Prc_PricingData[Prc_Current];
                if (Object.keys(Prc_PricingData).length === 0) Prc_PricingData["Default"] = [];
                Prc_PopulateSources();
                Prc_RenderMatrix();
                Prc_SaveData(true);
            }
        }

        // 3. Ø±Ø³Ù… Ø§Ù„Ù…ØµÙÙˆÙØ© (Smart Render)
        function Prc_RenderMatrix() {
            const Prc_Source = document.getElementById('Prc_SourceSelect').value;
            const Prc_SearchTerm = document.getElementById('Prc_SearchInput').value.toLowerCase();
            const Prc_Container = document.getElementById('Prc_MatrixGrid');
            
            document.getElementById('Prc_PrintSourceName').innerText = Prc_Source;
            Prc_Container.innerHTML = '';

            const Prc_Areas = Prc_PricingData[Prc_Source] || [];

            Prc_Areas.forEach((Prc_Item, Prc_Index) => {
                if (Prc_SearchTerm && !Prc_Item.area.toLowerCase().includes(Prc_SearchTerm)) return;

                // Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„
                const Prc_BasePrice = parseFloat(Prc_Item.price);
                
                // Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶ Ù…Ø¹ Ø§Ù„Ø²ÙŠØ§Ø¯Ø© Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ Ù†Ø´Ø·Ø§
                let Prc_DisplayPrice = Prc_BasePrice;
                let Prc_NightBadgeHtml = '';
                
                if (Prc_IsNightActive) {
                    Prc_DisplayPrice += 0.50;
                    Prc_NightBadgeHtml = `<span class="night-badge">+0.50 Ù„ÙŠÙ„ÙŠ ğŸŒ™</span>`;
                }

                // Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„ØªØ±Ù†Ø¯
                let Prc_ColorClass = 'med-price';
                if (Prc_BasePrice < 3) Prc_ColorClass = 'low-price';
                if (Prc_BasePrice >= 5) Prc_ColorClass = 'high-price';

                const Prc_OfferClass = Prc_Item.isOffer ? 'gold-offer' : '';
                const Prc_StarClass = Prc_Item.isOffer ? 'active' : '';

                let Prc_TrendHtml = '';
                const Prc_OneDay = 24 * 60 * 60 * 1000;
                if (Prc_Item.lastMod && (Date.now() - Prc_Item.lastMod < Prc_OneDay)) {
                    Prc_TrendHtml = '<span class="trend-icon">ğŸ“ˆ Ù…Ø­Ø¯Ø«</span>';
                }

                Prc_Container.innerHTML += `
                    <div class="price-card ${Prc_OfferClass}">
                        <div class="color-indicator ${Prc_ColorClass}"></div>
                        ${Prc_TrendHtml}
                        
                        <input type="text" class="area-name-input" value="${Prc_Item.area}" onchange="Prc_UpdateItem('${Prc_Source}', ${Prc_Index}, 'area', this.value)">
                        
                        <div class="price-wrapper">
                            ${Prc_NightBadgeHtml}
                            <input type="number" class="price-val-input" value="${Prc_DisplayPrice.toFixed(2)}" step="0.25" onchange="Prc_UpdateItem('${Prc_Source}', ${Prc_Index}, 'price', this.value)">
                        </div>
                        
                        <div class="card-tools">
                            <span style="font-size:10px; color:#777;">Ø¯.Ø£</span>
                            
                            <button class="mini-btn btn-map" onclick="Prc_OpenMap('${Prc_Item.area}', '${Prc_Source}')" title="Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©">ğŸ“</button>
                            
                            <button class="mini-btn btn-offer ${Prc_StarClass}" onclick="Prc_ToggleOffer('${Prc_Source}', ${Prc_Index})" title="ØªÙ…ÙŠÙŠØ² ÙƒØ¹Ø±Ø¶ Ø®Ø§Øµ">â­</button>
                            
                            <button class="mini-btn" onclick="Prc_DeleteItem('${Prc_Source}', ${Prc_Index})" style="color:#ff5252;">Ã—</button>
                        </div>
                    </div>
                `;
            });
        }

        // 4. Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ (Manual Edit)
        function Prc_UpdateItem(Prc_Source, Prc_Index, Prc_Field, Prc_Value) {
            // Ø¥Ø°Ø§ Ø¹Ø¯Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¯Ù†Ø§ Ù†Ø­ÙØ¸ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
            if (Prc_Field === 'price') {
                let Prc_NewVal = parseFloat(Prc_Value);
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ Ø´ØºØ§Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø´Ø§ÙŠÙ Ø§Ù„Ø³Ø¹Ø± Ø²Ø§Ø¦Ø¯ Ù†ØµÙ
                // Ù„Ù…Ø§ ÙŠØ¹Ø¯Ù„ Ù‡Ùˆ Ø¨ÙŠØ¹Ø¯Ù„ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ÙÙ„Ø§Ø²Ù… Ù†Ø®ØµÙ… Ø§Ù„Ø²ÙŠØ§Ø¯Ø© Ø¹Ø´Ø§Ù† Ù†Ø­ÙØ¸ Ø§Ù„Ø£Ø³Ø§Ø³
                if (Prc_IsNightActive) {
                    Prc_NewVal -= 0.50; 
                }
                // Ù…Ù†Ø¹ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø³Ø§Ù„Ø¨Ø©
                if (Prc_NewVal < 0) Prc_NewVal = 0;
                
                Prc_PricingData[Prc_Source][Prc_Index].price = Prc_NewVal;
                Prc_PricingData[Prc_Source][Prc_Index].lastMod = Date.now();
            } else {
                Prc_PricingData[Prc_Source][Prc_Index][Prc_Field] = Prc_Value;
            }
            Prc_RenderMatrix();
        }

        function Prc_AddArea() {
            const Prc_Source = document.getElementById('Prc_SourceSelect').value;
            const Prc_Name = prompt("Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©");
            if (Prc_Name) {
                Prc_PricingData[Prc_Source].push({ area: Prc_Name, price: 0, isOffer: false, lastMod: Date.now() });
                Prc_RenderMatrix();
            }
        }

        function Prc_DeleteItem(Prc_Source, Prc_Index) {
            if(confirm("Ø­Ø°Ù Ø§Ù„Ù…Ù†Ø·Ù‚Ø©")) {
                Prc_PricingData[Prc_Source].splice(Prc_Index, 1);
                Prc_RenderMatrix();
            }
        }

        function Prc_ToggleOffer(Prc_Source, Prc_Index) {
            Prc_PricingData[Prc_Source][Prc_Index].isOffer = !Prc_PricingData[Prc_Source][Prc_Index].isOffer;
            Prc_RenderMatrix();
        }

        function Prc_OpenMap(Prc_Area, Prc_Source) {
            const Prc_Query = encodeURIComponent(`${Prc_Area} ${Prc_Source} Jordan`);
            window.open(`http://googleusercontent.com/maps.google.com/search?q=${Prc_Query}`, '_blank');
        }

        // 5. Ø§Ù„Ø­ÙØ¸ (The Bridge)
        function Prc_SaveData(Prc_Silent = false) {
            localStorage.setItem('Prc_GlobalPricesDB', JSON.stringify(Prc_PricingData));
            
            if (!Prc_Silent) {
                const Prc_Btn = document.querySelector('.btn-save');
                const Prc_OriginalHtml = Prc_Btn.innerHTML;
                Prc_Btn.innerHTML = "ØªÙ… Ø§Ù„ØªØ¹Ù…ÙŠÙ… ğŸ“¡";
                Prc_Btn.style.background = "#004d40";
                setTimeout(() => {
                    Prc_Btn.innerHTML = Prc_OriginalHtml;
                    Prc_Btn.style.background = "var(--success)";
                    alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„ØªØ³Ø¹ÙŠØ± Ø§Ù„Ù„ÙŠÙ„ÙŠ " + (Prc_IsNightActive ? "Ù†Ø´Ø·" : "Ù…ØªÙˆÙ‚Ù") + " ÙˆØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ù„Ø¯Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø´Ø¢Øª");
                }, 1000);
            }
        }

    </script>
</body>
</html>
