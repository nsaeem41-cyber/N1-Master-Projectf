<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>N One | Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f6f8;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .main-container {
            width: 100%;
            max-width: 500px;
            margin-top: 20px;
        }

        .header { text-align: center; margin-bottom: 25px; }
        .n-char { color: #1a237e; font-size: 40px; font-weight: 800; }
        .one-word { color: #d4af37; font-size: 40px; font-weight: 800; }
        .comp-name { color: #555; font-size: 18px; margin-top: 5px; font-weight: bold; }

        /* ÙƒØ±ÙˆØª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
        .stats-row { display: flex; gap: 15px; margin-bottom: 25px; }
        .stat-card {
            background: white; flex: 1; padding: 20px 15px;
            border-radius: 15px; text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-bottom: 4px solid #1a237e;
        }
        .stat-title { color: #777; font-size: 13px; margin-bottom: 8px; font-weight: bold; }
        .stat-value { color: #1a237e; font-size: 20px; font-weight: 900; }

        /* Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø·Ù„Ø¨ */
        .order-form {
            background: white; padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            border-top: 6px solid #d4af37;
        }

        .form-title {
            text-align: center; color: #1a237e; font-size: 18px;
            margin-bottom: 25px; font-weight: bold;
            border-bottom: 1px solid #eee; padding-bottom: 15px;
        }

        .input-group { margin-bottom: 15px; }
        .label-text { font-size: 12px; color: #666; margin-bottom: 5px; display: block; font-weight: bold; }

        input {
            width: 100%; padding: 14px;
            border: 2px solid #f0f0f0; border-radius: 12px;
            font-size: 15px; box-sizing: border-box; outline: none;
            transition: 0.3s; text-align: right; background-color: #fafafa;
        }
        input:focus { border-color: #1a237e; background-color: #fff; }

        /* Ø­Ù‚Ù„ Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø¨ØªÙ† Ø§Ù„Ù…Ù…ÙŠØ² */
        .captain-field input {
            border-color: #d4af37;
            background-color: #fffde7;
        }

        .btn-whatsapp {
            width: 100%; padding: 16px;
            background: #25D366; /* Ù„ÙˆÙ† ÙˆØ§ØªØ³Ø§Ø¨ */
            color: white; border: none; border-radius: 12px;
            font-size: 18px; font-weight: bold; cursor: pointer;
            margin-top: 20px; transition: 0.3s;
            display: flex; justify-content: center; align-items: center; gap: 10px;
        }
        .btn-whatsapp:hover { background: #128C7E; transform: translateY(-2px); }

        .logout-link {
            display: block; text-align: center; margin-top: 25px;
            color: #c62828; text-decoration: none; font-size: 14px; font-weight: bold; cursor: pointer;
        }

        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 999;
            display: flex; justify-content: center; align-items: center;
            flex-direction: column;
        }
    </style>
</head>
<body>

    <div id="loading-screen">
        <h2 style="color:#1a237e;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù…...</h2>
    </div>

    <div class="main-container" id="app-content" style="display:none;">
        
        <div class="header">
            <div><span class="n-char">N</span><span class="one-word">One</span></div>
            <div class="comp-name" id="display-name">...</div>
        </div>

        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-title">Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>
                <div class="stat-value">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠØ©</div>
                <div class="stat-value">0.00</div>
            </div>
        </div>

        <div class="order-form">
            <div class="form-title">Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ù„Ù„ÙƒØ§Ø¨ØªÙ† (ÙˆØ§ØªØ³Ø§Ø¨)</div>

            <div class="input-group captain-field">
                <span class="label-text">Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø¨ØªÙ† (Ø³ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 962 ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)</span>
                <input type="tel" id="captain_phone" placeholder="Ù…Ø«Ø§Ù„: 0791234567">
            </div>

            <hr style="border: 0; border-top: 1px dashed #ccc; margin: 20px 0;">

            <div class="input-group">
                <span class="label-text">Ø§Ø³Ù… ÙˆÙ…ÙˆÙ‚Ø¹ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (Ø§Ù„Ù…Ø·Ø¹Ù…/Ø§Ù„Ù…ØªØ¬Ø±)</span>
                <input type="text" id="pickup_loc" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø·Ø¹Ù… Ù‡Ø§Ø´Ù… - ÙˆØ³Ø· Ø§Ù„Ø¨Ù„Ø¯">
            </div>

            <div class="input-group">
                <span class="label-text">Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø§Ù„Ø²Ø¨ÙˆÙ† (Ø§Ù„Ù…Ø³ØªÙ„Ù…)</span>
                <input type="tel" id="cust_phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†">
            </div>

            <div class="input-group">
                <span class="label-text">Ù…ÙˆÙ‚Ø¹ ØªÙˆØµÙŠÙ„ Ø§Ù„Ø²Ø¨ÙˆÙ†</span>
                <input type="text" id="drop_loc" placeholder="Ø§Ù„Ù…Ù†Ø·Ù‚Ø© / Ø§Ù„Ø´Ø§Ø±Ø¹">
            </div>

            <div class="input-group">
                <span class="label-text">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¯ÙØ¹ (Ø§Ù„Ù‚ÙŠÙ…Ø© + Ø§Ù„ØªÙˆØµÙŠÙ„)</span>
                <input type="text" id="price_info" placeholder="Ù…Ø«Ø§Ù„: 20 Ø¯ÙŠÙ†Ø§Ø± Ø´Ø§Ù…Ù„ Ø§Ù„ØªÙˆØµÙŠÙ„">
            </div>

            <button class="btn-whatsapp" onclick="sendToWhatsApp()">
                Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„ÙƒØ§Ø¨ØªÙ† Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ ğŸš€
            </button>
        </div>

        <div class="logout-link" onclick="logout()">Ø®Ø±ÙˆØ¬</div>
    </div>

    <script>
        const API_URL = "https://sheetdb.io/api/v1/zuo2qyjeryhxm";

        window.onload = function() {
            checkAuth();
        };

        async function checkAuth() {
            const localData = JSON.parse(localStorage.getItem('currentUser'));
            if (!localData) { window.location.href = 'index.html'; return; }
            
            // Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø© Ù…Ø¨Ø§Ø´Ø±Ø© Ù„ØªØ³Ø±ÙŠØ¹ Ø§Ù„Ø£Ø¯Ø§Ø¡
            document.getElementById('display-name').innerText = localData.name;
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('app-content').style.display = 'block';
        }

        function sendToWhatsApp() {
            // 1. Ø¬Ù„Ø¨ Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø¨ØªÙ† ÙˆØªÙ†Ø¸ÙŠÙÙ‡
            let capPhone = document.getElementById('captain_phone').value;
            
            if (!capPhone) { alert("Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø¨ØªÙ† Ø£ÙˆÙ„Ø§Ù‹!"); return; }

            // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø£Ø±Ø¯Ù†ÙŠ (Ø­Ø°Ù Ø§Ù„ØµÙØ± ÙˆØ¥Ø¶Ø§ÙØ© 962)
            capPhone = capPhone.replace(/\D/g, ''); // Ø­Ø°Ù Ø£ÙŠ Ø±Ù…ÙˆØ² ØºÙŠØ± Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
            if (capPhone.startsWith('0')) {
                capPhone = capPhone.substring(1);
            }
            if (!capPhone.startsWith('962')) {
                capPhone = '962' + capPhone;
            }

            // 2. Ø¬Ù„Ø¨ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            const pickup = document.getElementById('pickup_loc').value;
            const custPhone = document.getElementById('cust_phone').value;
            const drop = document.getElementById('drop_loc').value;
            const price = document.getElementById('price_info').value;

            if (!pickup || !drop) { alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹"); return; }

            // 3. ØµÙ†Ø¹ Ø±Ø§Ø¨Ø· Ø®Ø±Ø§Ø¦Ø· Ø¬ÙˆØ¬Ù„ Ø§Ù„Ø°ÙƒÙŠ
            // Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· ÙŠØ¨Ø­Ø« ÙÙŠ Ø¬ÙˆØ¬Ù„ Ù…Ø§Ø¨ Ø¹Ù† Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù…ÙƒØªÙˆØ¨
            const mapLink = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(pickup)}`;

            // 4. ØªØ¬Ù‡ÙŠØ² Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
            const message = `*Ø·Ù„Ø¨ ØªÙˆØµÙŠÙ„ Ø¬Ø¯ÙŠØ¯ - N One* ğŸ“¦\n\n` +
                            `ğŸ“ *Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Google Maps):* \n${mapLink}\n\n` +
                            `ğŸª *Ø§Ù„Ù…ØªØ¬Ø±/Ø§Ù„Ù…Ø·Ø¹Ù…:* ${pickup}\n` +
                            `ğŸ‘¤ *Ø±Ù‚Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†:* ${custPhone}\n` +
                            `ğŸ  *Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø²Ø¨ÙˆÙ†:* ${drop}\n` +
                            `ğŸ’° *Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø§Ù„ÙŠØ©:* ${price}\n\n` +
                            `---\nÙŠØ±Ø¬Ù‰ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… ğŸš€`;

            // 5. ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨
            const waLink = `https://wa.me/${capPhone}?text=${encodeURIComponent(message)}`;
            window.open(waLink, '_blank');
        }

        function logout() {
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>
