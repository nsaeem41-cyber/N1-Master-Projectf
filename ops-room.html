<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>N One | ØºØ±ÙØ© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ© (Live Ops)</title>
    
    <script src="https://cdn.jsdelivr.net/gh/nsaeem41-cyber/N1-Master-Project@main/n-one-core.js"></script>

    <style>
        /* ================= ØªØµÙ…ÙŠÙ… Ops Room Pro (Dark Mode Hybrid) ================= */
        :root {
            --primary: #00695c; --gold: #d4af37; --bg: #e0f2f1; --text: #333;
            --dark-panel: #263238; --light-panel: #ffffff;
            --success: #2e7d32; --danger: #c62828; --money: #1b5e20;
        }

        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg); margin: 0; padding: 0; color: var(--text); user-select: none; overflow-x: hidden; }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…Ù„ÙƒÙŠ */
        .navbar { background: var(--dark-panel); height: 60px; display: flex; justify-content: space-between; align-items: center; padding: 0 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); position: sticky; top: 0; z-index: 1000; border-bottom: 3px solid var(--gold); }
        .brand { font-size: 20px; font-weight: 900; color: white; letter-spacing: 1px; }
        .gold-text { color: var(--gold); }
        
        .status-badge { background: rgba(0, 255, 0, 0.1); color: #00e676; padding: 5px 15px; border-radius: 20px; font-size: 12px; font-weight: bold; display: flex; align-items: center; gap: 5px; border: 1px solid #00e676; }
        .live-dot { height: 8px; width: 8px; background-color: #00e676; border-radius: 50%; display: inline-block; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(0, 230, 118, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(0, 230, 118, 0); } 100% { box-shadow: 0 0 0 0 rgba(0, 230, 118, 0); } }

        /* ØªØ®Ø·ÙŠØ· Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ù†Ù‚Ø³Ù…Ø© (Split Screen) */
        .ops-container { display: grid; grid-template-columns: 65% 35%; height: calc(100vh - 60px); }
        
        /* Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙŠÙ…Ù†: Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø­ÙŠØ© */
        .live-section { padding: 20px; overflow-y: auto; border-left: 2px solid #b0bec5; }
        
        /* Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙŠØ³Ø±: Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙŠØ¯ÙˆÙŠ */
        .manual-section { background: white; padding: 20px; overflow-y: auto; box-shadow: -5px 0 15px rgba(0,0,0,0.05); }

        /* Ø§Ù„ÙƒØ±ÙˆØª ÙˆØ§Ù„Ø¬Ø¯Ø§ÙˆÙ„ */
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 3px 10px rgba(0,0,0,0.05); margin-bottom: 20px; border-top: 4px solid var(--primary); }
        .card-header { font-size: 16px; font-weight: bold; color: var(--primary); margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding-bottom: 10px; }

        table { width: 100%; border-collapse: collapse; font-size: 13px; }
        thead { background: #f5f5f5; position: sticky; top: 0; }
        th, td { padding: 12px; text-align: right; border-bottom: 1px solid #eee; }
        tr:hover { background-color: #f1f8e9; }

        .badge { padding: 4px 8px; border-radius: 4px; font-weight: bold; font-size: 11px; }
        .bg-money { background: #e8f5e9; color: var(--money); }
        .bg-loc { background: #e3f2fd; color: #1565c0; text-decoration: none; }
        .bg-phone { background: #fff3e0; color: #e65100; font-family: monospace; }

        /* ÙÙˆØ±Ù… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙŠØ¯ÙˆÙŠ */
        .manual-form { display: flex; flex-direction: column; gap: 10px; }
        input { padding: 10px; border: 1px solid #cfd8dc; border-radius: 6px; outline: none; background: #fafafa; width: 100%; box-sizing: border-box; }
        input:focus { border-color: var(--primary); background: white; }
        
        .btn-whatsapp { background: #25d366; color: white; border: none; padding: 12px; border-radius: 6px; font-weight: bold; cursor: pointer; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-whatsapp:hover { background: #128c7e; transform: translateY(-2px); }

        /* ØªÙ„Ù…ÙŠØ­ Ø§Ù„Ø°Ø§ÙƒØ±Ø© */
        .memory-hint { font-size: 11px; color: var(--primary); background: #e0f2f1; padding: 5px; border-radius: 4px; display: none; margin-top: -5px; margin-bottom: 5px; }

        /* Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø§Ù„Ù…ØµØºØ± */
        .mini-archive { font-size: 11px; margin-top: 20px; border-top: 2px dashed #eee; padding-top: 10px; }
        .mini-archive h4 { margin: 0 0 10px 0; color: #555; }

        /* Ø§Ù„ØªØ¬Ø§ÙˆØ¨ */
        @media (max-width: 900px) { .ops-container { grid-template-columns: 1fr; height: auto; } .live-section { border-left: none; border-bottom: 2px solid #ddd; } }
    </style>
</head>
<body onclick="enableSound()">

    <audio id="notif-sound" preload="auto">
        <source src="https://assets.mixkit.co/active_storage/sfx/2354/2354-preview.mp3" type="audio/mpeg">
    </audio>

    <nav class="navbar">
        <div class="brand">N <span class="gold-text">One</span> Operations</div>
        <div class="status-badge"><span class="live-dot"></span> Ù…ØªØµÙ„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ± v7.0</div>
    </nav>

    <div class="ops-container">
        
        <div class="live-section">
            <div class="card">
                <div class="card-header">
                    <span>ğŸ“¡ Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ø·Ù„Ø¨Ø§Øª (Live Feed)</span>
                    <span id="order-count" style="background:var(--primary); color:white; padding:2px 8px; border-radius:10px; font-size:12px;">0</span>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Ø§Ù„ÙˆÙ‚Øª</th>
                            <th>Ø§Ù„Ù…ØµØ¯Ø± (Ø§Ù„Ù…Ù†Ø´Ø£Ø©)</th>
                            <th>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø´Ø£Ø©</th>
                            <th>Ø§Ù„Ù‚ÙŠÙ…Ø©</th>
                            <th>Ø§Ù„ØªÙˆØµÙŠÙ„</th>
                        </tr>
                    </thead>
                    <tbody id="live-table-body">
                        <tr><td colspan="5" style="text-align:center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø£Ù‚Ù…Ø§Ø± Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©... ğŸ›°ï¸</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="manual-section">
            <div class="card">
                <div class="card-header">
                    <span>ğŸ“² Ø§Ù„Ù…Ø±Ø³Ù„ Ø§Ù„ÙŠØ¯ÙˆÙŠ (WhatsApp)</span>
                    <span>âš¡</span>
                </div>
                
                <div class="manual-form">
                    <div>
                        <input type="tel" id="man_phone" placeholder="Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø¨ØªÙ† (07xxxxxxxx)" oninput="checkCaptainMemory()">
                        <div id="mem_hint" class="memory-hint">âœ¨ ØªÙ… Ø§Ù„ØªØ¹Ø±Ù: <span id="mem_name"></span></div>
                    </div>

                    <input type="text" id="man_cap_name" placeholder="Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ø¨ØªÙ†">
                    <input type="text" id="man_rest_name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù… / Ø§Ù„Ù…ÙˆÙ‚Ø¹">
                    
                    <div style="display:flex; gap:5px;">
                        <input type="number" id="man_val" placeholder="Ù‚ÙŠÙ…Ø© Ø§Ù„Ø·Ù„Ø¨">
                        <input type="number" id="man_fee" placeholder="Ø§Ù„ØªÙˆØµÙŠÙ„">
                    </div>

                    <div style="display:flex; gap:5px;">
                        <input type="number" id="man_ratio" placeholder="Ø§Ù„Ù†Ø³Ø¨Ø© %" style="border-color:var(--gold);">
                    </div>

                    <button class="btn-whatsapp" onclick="sendManualOrder()">
                        Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³Ø§Ø¨ ÙˆØªÙˆØ«ÙŠÙ‚ ğŸ“¤
                    </button>
                </div>
            </div>

            <div class="mini-archive">
                <h4>ğŸ—‚ï¸ Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø§Ù„ÙŠÙˆÙ…ÙŠ (Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„Ù„Ø­Ø¸ÙŠ)</h4>
                <div style="margin-bottom:10px; font-weight:bold; color:var(--money);">
                    Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø§Øª Ø§Ù„ÙŠÙˆÙ…: <span id="daily-total">0.00</span> Ø¯.Ø£
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Ø§Ù„ÙƒØ§Ø¨ØªÙ†</th>
                            <th>Ø§Ù„Ù…Ø·Ø¹Ù…</th>
                            <th>Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©</th>
                            <th>Ø­Ø°Ù</th>
                        </tr>
                    </thead>
                    <tbody id="archive-body">
                        <tr><td colspan="4" style="text-align:center;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª ÙŠØ¯ÙˆÙŠØ© Ø§Ù„ÙŠÙˆÙ…</td></tr>
                    </tbody>
                </table>
                <button onclick="clearDailyArchive()" style="width:100%; margin-top:10px; padding:8px; border:none; background:#eceff1; color:#555; cursor:pointer; border-radius:5px;">ØªØµÙÙŠØ± Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø§Ù„ÙŠÙˆÙ…ÙŠ ğŸ—‘ï¸</button>
            </div>
        </div>

    </div>

    <script>
        // ========================================================
        // ÙƒÙˆØ¯ ØºØ±ÙØ© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª - Ø§Ù„Ù‚Ù„Ø¨ Ø§Ù„Ù†Ø§Ø¨Ø¶ v7.0
        // ========================================================
        
        // Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù„ÙƒÙŠ (Ù†ÙØ³ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Client Ùˆ Admin)
        if (typeof N_ONE_CORE !== 'undefined') {
            N_ONE_CORE.API_URL = "https://script.google.com/macros/s/AKfycbybaX1dgu-rVIkUAz2w6H2NdYIuv3zKkmPbHON8NTRclD3H6cVgyW5SAzFfAPNcMt6g/exec";
        }

        let allData = [];
        let lastOrderCount = 0;
        let soundEnabled = false;
        
        // Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ù„Ù„ÙƒØ¨Ø§ØªÙ† ÙˆØ§Ù„Ø£Ø±Ø´ÙŠÙ
        let captainMemory = JSON.parse(localStorage.getItem('n1_captains') || '{}');
        let dailyArchive = JSON.parse(localStorage.getItem('n1_daily_archive') || '[]');

        window.onload = async function() {
            if (typeof N_ONE_CORE === 'undefined') { alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†ÙˆØ§Ø©!"); return; }
            
            // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ (Ø§Ù„Ù†Ø¨Ø¶)
            await fetchData();
            setInterval(fetchDataSilent, 5000); // ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 5 Ø«ÙˆØ§Ù†ÙŠ Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©
            
            renderArchive(); // Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø§Ù„Ù…Ø­ÙÙˆØ¸
        };

        // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª Ø¨Ø°ÙƒØ§Ø¡ (Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù†Ø¯ Ø£ÙˆÙ„ Ù†Ù‚Ø±Ø©)
        function enableSound() {
            if (!soundEnabled) {
                const audio = document.getElementById('notif-sound');
                audio.play().then(() => { audio.pause(); audio.currentTime = 0; soundEnabled = true; }).catch(() => {});
            }
        }

        async function fetchData() {
            try {
                // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±
                allData = await N_ONE_CORE.fetchData('read');
                renderLiveTable();
            } catch (e) { console.error("Connection Error", e); }
        }

        async function fetchDataSilent() {
            try {
                const newData = await N_ONE_CORE.fetchData('read');
                if (newData.length > 0) { allData = newData; renderLiveTable(); }
            } catch (e) {}
        }

        // ================= Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙŠÙ…Ù†: Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ø·Ù„Ø¨Ø§Øª =================
        function renderLiveTable() {
            const tbody = document.getElementById('live-table-body');
            
            // ÙÙ„ØªØ±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙ‚Ø·
            const orders = allData.filter(i => i.type === 'order').reverse();
            document.getElementById('order-count').innerText = orders.length;

            // Ù…Ù†Ø·Ù‚ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„ØµÙˆØªÙŠ Ø§Ù„Ø®Ø§Ø±Ù‚
            if (orders.length > lastOrderCount && lastOrderCount !== 0) {
                const audio = document.getElementById('notif-sound');
                audio.play().catch(e => console.log("Sound blocked"));
            }
            lastOrderCount = orders.length;

            if (orders.length === 0) { tbody.innerHTML = '<tr><td colspan="5" style="text-align:center; padding:20px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù†Ø´Ø·Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ ğŸ˜´</td></tr>'; return; }
            
            tbody.innerHTML = '';
            orders.forEach(ord => {
                // Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ Ø¹Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø´Ø£Ø© (Ø§Ù„Ù‡Ø§ØªÙ ÙˆØ§Ù„Ù…ÙˆÙ‚Ø¹) Ù…Ù† Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø¹Ø§Ù…
                // Ù†Ø³ØªØ®Ø¯Ù… client_user Ù„Ù„Ø¨Ø­Ø« ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                const shopData = allData.find(u => String(u.user) === String(ord.client_user) && u.type === 'shop');
                
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø´Ø£Ø© Ø§Ù„Ù…Ø³Ø¬Ù„Ø©ØŒ Ø«Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø© Ù…Ø¹ Ø§Ù„Ø·Ù„Ø¨)
                const shopPhone = shopData ? (shopData.cap_phone || 'ØºÙŠØ± Ù…Ø³Ø¬Ù„') : '---';
                let shopLoc = shopData ? (shopData.pickup || '#') : '#';
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ø§Ù„Ø·Ù„Ø¨ Ù†ÙØ³Ù‡ (Ù„Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠØ¯ÙˆÙŠØ© Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø±) Ù†Ø³ØªØ®Ø¯Ù…Ù‡
                if (ord.pickup && ord.pickup.includes('http')) shopLoc = ord.pickup;

                // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙˆÙ‚Øª
                let time = ord.date.split('T')[1] ? ord.date.split('T')[1].substring(0,5) : 'Now';

                tbody.innerHTML += `
                    <tr>
                        <td><b>${time}</b></td>
                        <td style="color:var(--primary); font-weight:bold;">${ord.cl_name || 'Ù…Ø·Ø¹Ù…'}</td>
                        <td>
                            <span class="badge bg-phone">${shopPhone}</span>
                            <a href="${shopLoc}" target="_blank" class="badge bg-loc">ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹</a>
                        </td>
                        <td><span class="badge bg-money">${ord.val} Ø¯.Ø£</span></td>
                        <td>${ord.fee}</td>
                    </tr>
                `;
            });
        }

        // ================= Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙŠØ³Ø±: Ø§Ù„Ù…Ø±Ø³Ù„ Ø§Ù„ÙŠØ¯ÙˆÙŠ ÙˆØ§Ù„Ø£Ø±Ø´ÙŠÙ =================
        
        function checkCaptainMemory() {
            const phone = document.getElementById('man_phone').value;
            const hint = document.getElementById('mem_hint');
            
            if (captainMemory[phone]) {
                hint.style.display = 'block';
                document.getElementById('mem_name').innerText = captainMemory[phone];
                document.getElementById('man_cap_name').value = captainMemory[phone];
            } else {
                hint.style.display = 'none';
            }
        }

        function sendManualOrder() {
            const phone = document.getElementById('man_phone').value;
            const capName = document.getElementById('man_cap_name').value;
            const restName = document.getElementById('man_rest_name').value;
            const val = document.getElementById('man_val').value;
            const fee = document.getElementById('man_fee').value;
            const ratio = document.getElementById('man_ratio').value || 0;

            if (!phone || !restName) { alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… ÙˆØ§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù… â˜ºï¸"); return; }

            // 1. Ø­ÙØ¸ Ø§Ù„ÙƒØ§Ø¨ØªÙ† ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©
            if (capName) {
                captainMemory[phone] = capName;
                localStorage.setItem('n1_captains', JSON.stringify(captainMemory));
            }

            // 2. Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù…Ù„ÙƒÙŠ
            let finalPhone = phone.startsWith('0') ? '962' + phone.substring(1) : phone;
            // Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 0 ÙˆÙ„Ø§ 962ØŒ Ù†ÙØªØ±Ø¶ Ø£Ù†Ù‡ Ø¯ÙˆÙ„ÙŠ Ø£Ùˆ Ù†Ø¶ÙŠÙ 962
             if (!finalPhone.startsWith('962')) finalPhone = '962' + phone;

            const msg = `*Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ - N One* ğŸš€%0a` +
                        `ğŸ‘¤ Ø§Ù„ÙƒØ§Ø¨ØªÙ†: ${capName}%0a` +
                        `ğŸª Ø§Ù„Ù…Ø·Ø¹Ù…: ${restName}%0a` +
                        `ğŸ’° Ø§Ù„Ù‚ÙŠÙ…Ø©: ${val} Ø¯.Ø£%0a` +
                        `ğŸ›µ Ø§Ù„ØªÙˆØµÙŠÙ„: ${fee} Ø¯.Ø£%0a` +
                        `-- Ø¨Ø§Ù„ØªÙˆÙÙŠÙ‚! --`;
            
            window.open(`https://wa.me/${finalPhone}?text=${msg}`, '_blank');

            // 3. Ø§Ù„ØªÙˆØ«ÙŠÙ‚ ÙÙŠ Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø§Ù„ÙŠÙˆÙ…ÙŠ
            const commission = (parseFloat(fee || 0) * (parseFloat(ratio) / 100)).toFixed(2);
            
            const logEntry = {
                id: Date.now(),
                cap: capName || phone,
                rest: restName,
                comm: commission
            };
            
            dailyArchive.unshift(logEntry);
            localStorage.setItem('n1_daily_archive', JSON.stringify(dailyArchive));
            renderArchive();

            // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø­Ù‚ÙˆÙ„ (Ù…Ø§ Ø¹Ø¯Ø§ Ø§Ù„Ù†Ø³Ø¨Ø© Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„ØªÙƒØ±Ø§Ø±)
            document.getElementById('man_rest_name').value = '';
            document.getElementById('man_val').value = '';
            document.getElementById('man_fee').value = '';
        }

        function renderArchive() {
            const tbody = document.getElementById('archive-body');
            let totalComm = 0;
            
            if (dailyArchive.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align:center; font-size:11px; color:#aaa;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª ÙŠØ¯ÙˆÙŠØ© Ø§Ù„ÙŠÙˆÙ…</td></tr>';
                document.getElementById('daily-total').innerText = "0.00";
                return;
            }

            tbody.innerHTML = '';
            dailyArchive.forEach((item, index) => {
                totalComm += parseFloat(item.comm);
                tbody.innerHTML += `
                    <tr>
                        <td>${item.cap}</td>
                        <td>${item.rest}</td>
                        <td style="color:var(--money); font-weight:bold;">${item.comm}</td>
                        <td><button onclick="deleteArchiveItem(${index})" style="background:none; border:none; cursor:pointer;">âŒ</button></td>
                    </tr>
                `;
            });
            document.getElementById('daily-total').innerText = totalComm.toFixed(2);
        }

        function deleteArchiveItem(index) {
            if(!confirm("Ø­Ø°Ù Ù…Ù† Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠØŸ")) return;
            dailyArchive.splice(index, 1);
            localStorage.setItem('n1_daily_archive', JSON.stringify(dailyArchive));
            renderArchive();
        }

        function clearDailyArchive() {
            if(!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØµÙÙŠØ± Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØŸ")) return;
            dailyArchive = [];
            localStorage.setItem('n1_daily_archive', JSON.stringify([]));
            renderArchive();
        }
    </script>
</body>
</html>
